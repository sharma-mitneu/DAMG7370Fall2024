{
	"name": "wf_stage_montgomery_raw",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_montgomery_raw",
						"type": "DatasetReference"
					},
					"name": "montgomeryRaw"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     DI_WORKFLOW_NAME as string (\"montgomery-adf\")",
				"}",
				"source(output(",
				"          {Report Number} as string,",
				"          {Local Case Number} as string,",
				"          {Agency Name} as string,",
				"          {ACRS Report Type} as string,",
				"          {Crash Date/Time} as string,",
				"          {Hit/Run} as string,",
				"          {Route Type} as string,",
				"          {Lane Direction} as string,",
				"          {Lane Type} as string,",
				"          {Number of Lanes} as string,",
				"          Direction as string,",
				"          Distance as double,",
				"          {Distance Unit} as string,",
				"          {Road Grade} as string,",
				"          {Road Name} as string,",
				"          {Cross-Street Name} as string,",
				"          {Off-Road Description} as string,",
				"          Municipality as string,",
				"          {Related Non-Motorist} as string,",
				"          {At Fault} as string,",
				"          {Collision Type} as string,",
				"          Weather as string,",
				"          {Surface Condition} as string,",
				"          Light as string,",
				"          {Traffic Control} as string,",
				"          {Driver Substance Abuse} as string,",
				"          {Non-Motorist Substance Abuse} as string,",
				"          {First Harmful Event} as string,",
				"          {Second Harmful Event} as string,",
				"          Junction as string,",
				"          {Intersection Type} as string,",
				"          {Road Alignment} as string,",
				"          {Road Condition} as string,",
				"          {Road Division} as string,",
				"          Latitude as double,",
				"          Longitude as double,",
				"          Location as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> montgomeryRaw",
				"montgomeryRaw derive(CITY = \"MONTGOMERY\",",
				"          COUNTRY = \"UNITED STATES\",",
				"          DI_SOURCE_NAME = \"STG_MONTGOMERY\",",
				"          CRASH_DATE_TIME = toTimestamp({Crash Date/Time}, 'MM/dd/yyyy hh:mm:ss a'),",
				"          DI_CREATED_DATE = toString(currentDate(), 'yyyy-MM-dd'),",
				"          DI_WORKFLOW_NAME = $DI_WORKFLOW_NAME,",
				"          Location_New = concat('POINT(', toString(Longitude), ' ', toString(Latitude), ')')",
				") ~> derivedColumn1"
			]
		}
	}
}